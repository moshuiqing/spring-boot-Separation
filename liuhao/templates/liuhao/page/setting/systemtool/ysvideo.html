<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:shiro="https://www.pollix.at/thymeleaf/shiro">
	<div th:include="@{/ty.html}"></div>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
		<meta name="misapplication-tap-highlight" content="no" />
		<meta name="HandheldFriendly" content="true" />
		<meta name="MobileOptimized" content="320" />
		<title>My JSP 'index.jsp' starting page</title>
		<meta http-equiv="pragma" content="no-cache">
		<meta http-equiv="cache-control" content="no-cache">
		<meta http-equiv="expires" content="0">
		<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
		<meta http-equiv="description" content="This is my page">
		<link rel="stylesheet" th:href="@{/layui/css/layui.css}">
		<link rel="stylesheet" th:href="@{/css/video-js.min.css}" />
		<link rel="stylesheet" th:href="@{/css/public.css}" media="all" />
		<script type="text/javascript" th:src="@{/myjs/jquery-1.8.3.js}"></script>
		<script type="text/javascript" th:src="@{/layui/layui.js}"></script>
		<script type="text/javascript" th:src="@{/myjs/video.min.js}"></script>
	</head>
	<body class="childrenBody">
		<div style="overflow: hidden;">

			<div style="width: 45%;border: 1px solid black;float: left;">
				<video id="my-video" class="video-js" controls preload="auto" width="500" height="400" poster="" data-setup="{}">
					<source id="url" th:src="@{/vodie/qq.flv}" type="video/mp4">
				</video>
				<button type="button" class="layui-btn" id="test3">
					<i class="layui-icon">&#xe67c;</i>视频压缩
				</button>
				
			</div>
			<div style="width: 45%;float: right;border: 1px solid black;">
				<video id="path" width="500" height="400" controls="" name="media" type="video/mp4">

				</video>
				<button type="button" class="layui-btn" id="test1">
					<i class="layui-icon">&#xe67c;</i>上传视频转码为MP4
				</button>
			</div>
			<br />
		</div>
		<div>
			<img id="spjt" />
			<br />
			<button type="button" class="layui-btn" id="test2">
				<i class="layui-icon">&#xe67c;</i>视频截图
			</button>
		</div>
		<div>
			<button type="button" class="layui-btn" id="send">
				<i class="layui-icon">&#xe67c;</i>微信推送
			</button>
		</div>
		<div>
			<a th:href="@{/ys/xiaZai}">下载</a>
		</div>
		<script type="text/javascript">
			$(function(){
				
				$("#send").click(function(){
					
					$.post(webname + "/wx/sendWxMb", null, function(d) {
						
						alert(d.msg);
					})
					
				})
				
			})
		</script>
		<script type="text/javascript">
			//设置中文
			function init() {
				videojs.addLanguage('zh-CN', {
					"Play": "播放",
					"Pause": "暂停",
					"Current Time": "当前时间",
					"Duration": "时长",
					"Remaining Time": "剩余时间",
					"Stream Type": "媒体流类型",
					"LIVE": "直播",
					"Loaded": "加载完毕",
					"Progress": "进度",
					"Fullscreen": "全屏",
					"Non-Fullscreen": "退出全屏",
					"Mute": "静音",
					"Unmute": "取消静音",
					"Playback Rate": "播放速度",
					"Subtitles": "字幕",
					"subtitles off": "关闭字幕",
					"Captions": "内嵌字幕",
					"captions off": "关闭内嵌字幕",
					"Chapters": "节目段落",
					"Close Modal Dialog": "关闭弹窗",
					"Descriptions": "描述",
					"descriptions off": "关闭描述",
					"Audio Track": "音轨",
					"You aborted the media playback": "视频播放被终止",
					"A network error caused the media download to fail part-way.": "网络错误导致视频下载中途失败。",
					"The media could not be loaded, either because the server or network failed or because the format is not supported.": "视频因格式不支持或者服务器或网络的问题无法加载。",
					"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.": "由于视频文件损坏或是该视频使用了你的浏览器不支持的功能，播放终止。",
					"No compatible source was found for this media.": "无法找到此视频兼容的源。",
					"The media is encrypted and we do not have the keys to decrypt it.": "视频已加密，无法解密。",
					"Play Video": "播放视频",
					"Close": "关闭",
					"Modal Window": "弹窗",
					"This is a modal window": "这是一个弹窗",
					"This modal can be closed by pressing the Escape key or activating the close button.": "可以按ESC按键或启用关闭按钮来关闭此弹窗。",
					", opens captions settings dialog": ", 开启标题设置弹窗",
					", opens subtitles settings dialog": ", 开启字幕设置弹窗",
					", opens descriptions settings dialog": ", 开启描述设置弹窗",
					", selected": ", 选择",
					"captions settings": "字幕设定",
					"Audio Player": "音频播放器",
					"Video Player": "视频播放器",
					"Replay": "重播",
					"Progress Bar": "进度小节",
					"Volume Level": "音量",
					"subtitles settings": "字幕设定",
					"descriptions settings": "描述设定",
					"Text": "文字",
					"White": "白",
					"Black": "黑",
					"Red": "红",
					"Green": "绿",
					"Blue": "蓝",
					"Yellow": "黄",
					"Magenta": "紫红",
					"Cyan": "青",
					"Background": "背景",
					"Window": "视窗",
					"Transparent": "透明",
					"Semi-Transparent": "半透明",
					"Opaque": "不透明",
					"Font Size": "字体尺寸",
					"Text Edge Style": "字体边缘样式",
					"None": "无",
					"Raised": "浮雕",
					"Depressed": "压低",
					"Uniform": "均匀",
					"Dropshadow": "下阴影",
					"Font Family": "字体库",
					"Proportional Sans-Serif": "比例无细体",
					"Monospace Sans-Serif": "单间隔无细体",
					"Proportional Serif": "比例细体",
					"Monospace Serif": "单间隔细体",
					"Casual": "舒适",
					"Script": "手写体",
					"Small Caps": "小型大写字体",
					"Reset": "重启",
					"restore all settings to the default values": "恢复全部设定至预设值",
					"Done": "完成",
					"Caption Settings Dialog": "字幕设定视窗",
					"Beginning of dialog window. Escape will cancel and close the window.": "开始对话视窗。离开会取消及关闭视窗",
					"End of dialog window.": "结束对话视窗"
				});




			}

			init();
		</script>

		<script type="text/javascript">
			layui.use(['form', 'layer', 'upload'], function() {
				var upload = layui.upload;
				var layer = layui.layer;
				var form = layui.form;

				//执行实例

				upload.render({
					elem: '#test1',
					url: webname + '/ftpup/uploadFile',
					method: "post", // 此处是为了演示之用，实际使用中请将此删除，默认用post方式提交
					field: 'file',
					accept: 'video',
					data: {
						INDEX: 2
					},
					done: function(res, index, upload) {
						if (res.code > 0) {
							var videopath = res.object;
							layer.msg("上传成功！正在转码。。。。请稍后。。。。。。");
							//保存头像
							$.post(webname + "/ys/ysVideo", {
								path: videopath
							}, function(d) {
								if (d.msg != null && d.msg != '') {
									layer.msg(d.msg);
								}

								if (d.code > 0) {
									var videoUrl = d.object; //此处填写你的视频地址
									//var myPlayer = videojs('my-video_html5_api');
									//myPlayer.src(videoUrl); /*动态设置video.js播放的地址。*/
									//myPlayer.load();

									$("#path").html("");
									var sourceDom = $("<source src=\"" + videoUrl + "\">");
									$("#path").append(sourceDom);
									//vid.play();


								} else {

								}

							});
						}
					},
					error: function() {
						//请求异常回调
					}
				});
				///////////////////////////
				upload.render({
					elem: '#test2',
					url: webname + '/ftpup/uploadFile',
					method: "post", // 此处是为了演示之用，实际使用中请将此删除，默认用post方式提交
					field: 'file',
					accept: 'video',
					data: {
						INDEX: 2
					},
					done: function(res, index, upload) {
						if (res.code > 0) {
							var videopath = res.object;
							layer.msg("上传成功！正在转码。。。。请稍后。。。。。。");
							//保存头像
							$.post(webname + "/ys/spJieTu", {
								path: videopath
							}, function(d) {
								if (d.msg != null && d.msg != '') {
									layer.msg(d.msg);
								}
				
								if (d.code > 0) {
									var videoUrl = d.object; //此处填写你的视频地址
									$("#spjt").attr("src",videoUrl);
								} else {
				
								}
				
							});
						}
					},
					error: function() {
						//请求异常回调
					}
				});
				
				///////////
				
				upload.render({
					elem: '#test3',
					url: webname + '/ftpup/uploadFile',
					method: "post", // 此处是为了演示之用，实际使用中请将此删除，默认用post方式提交
					field: 'file',
					accept: 'video',
					data: {
						INDEX: 2
					},
					done: function(res, index, upload) {
						if (res.code > 0) {
							var videopath = res.object;
							layer.msg("上传成功！正在转码。。。。请稍后。。。。。。");
							//保存头像
							$.post(webname + "/ys/spYs", {
								path: videopath
							}, function(d) {
								if (d.msg != null && d.msg != '') {
									layer.msg(d.msg);
								}
				
								if (d.code > 0) {
									var videoUrl = d.object; //此处填写你的视频地址
									alert(videoUrl)
								} else {
				
								}
				
							});
						}
					},
					error: function() {
						//请求异常回调
					}
				});


			});
		</script>

	</body>
</html>
